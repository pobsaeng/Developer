{"version":3,"file":"azureResource/services/tenantService.js","sourceRoot":"../src","sources":["azureResource/services/tenantService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,YAAY,CAAC;;;;;;;;;;AAEb,mCAAmC;AAKnC;IACc,WAAW,CAAC,YAAqD;;YAC7E,MAAM,kBAAkB,GAAG,IAAI,OAAO,CAAS,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAClE,MAAM,GAAG,GAAG,8CAA8C,YAAY,CAAC,EAAE,yBAAyB,CAAC;gBACnG,OAAO,CAAC,GAAG,EAAE,UAAU,KAAK,EAAE,QAAQ,EAAE,IAAI;oBAC3C,IAAI,QAAQ,CAAC,UAAU,KAAK,GAAG,EAAE;wBAChC,MAAM,aAAa,GAAG,sIAAsI,CAAC;wBAC7J,MAAM,aAAa,GAAG,QAAQ,CAAC,OAAO,CAAC,kBAAkB,CAAC,CAAC;wBAC3D,IAAI,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE;4BACtC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC9C;6BAAM;4BACN,MAAM,EAAE,CAAC;yBACT;qBACD;gBACF,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;YAEH,OAAO,MAAM,kBAAkB,CAAC;QACjC,CAAC;KAAA;CACD;AAnBD,gEAmBC","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the Source EULA. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport * as request from 'request';\n\nimport { azureResource } from '../azure-resource';\nimport { IAzureResourceTenantService } from '../interfaces';\n\nexport class AzureResourceTenantService implements IAzureResourceTenantService {\n\tpublic async getTenantId(subscription: azureResource.AzureResourceSubscription): Promise<string> {\n\t\tconst requestPromisified = new Promise<string>((resolve, reject) => {\n\t\t\tconst url = `https://management.azure.com/subscriptions/${subscription.id}?api-version=2014-04-01`;\n\t\t\trequest(url, function (error, response, body) {\n\t\t\t\tif (response.statusCode === 401) {\n\t\t\t\t\tconst tenantIdRegEx = /authorization_uri=\"https:\\/\\/login\\.windows\\.net\\/([0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12})\"/;\n\t\t\t\t\tconst teantIdString = response.headers['www-authenticate'];\n\t\t\t\t\tif (tenantIdRegEx.test(teantIdString)) {\n\t\t\t\t\t\tresolve(tenantIdRegEx.exec(teantIdString)[1]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn await requestPromisified;\n\t}\n}"]}